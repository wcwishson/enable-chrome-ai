diff --git a/main.py b/main.py
index 332e6c2..aff63c1 100644
--- a/main.py
+++ b/main.py
@@ -1,10 +1,18 @@
 import os
 import sys
 import json
+import time
 import subprocess
 
 import psutil
 
+MAC_CHROME_APP_NAMES = (
+    'Google Chrome',
+    'Google Chrome Canary',
+    'Google Chrome Dev',
+    'Google Chrome Beta',
+)
+
 
 def get_version_and_user_data_path():
     os_and_user_data_paths = {
@@ -40,27 +48,141 @@ def get_version_and_user_data_path():
     raise Exception('Unsupported platform %s' % sys.platform)
 
 
-def shutdown_chrome():
-    terminated_chromes = set()
+def is_target_chrome_process(process):
+    process_name = process.name()
+    if sys.platform == 'darwin':
+        return process_name in MAC_CHROME_APP_NAMES
+
+    if os.path.splitext(process_name)[0] != 'chrome':
+        return False
+
+    parent = process.parent()
+    if parent is not None and parent.name() == process_name:
+        return False
+
+    return True
+
+
+def collect_running_chromes():
+    running_chromes = []
     for process in psutil.process_iter():
         try:
-            if sys.platform == 'darwin':
-                if not process.name().startswith('Google Chrome'):
-                    continue
-            elif os.path.splitext(process.name())[0] != 'chrome':
+            if not process.is_running():
                 continue
-            elif not process.is_running():
+            if not is_target_chrome_process(process):
                 continue
-            elif process.parent() is not None and process.parent().name() == process.name():
-                continue
-            location = process.exe()
-            process.kill()
-            terminated_chromes.add(location)
-        except psutil.NoSuchProcess:
+            running_chromes.append(process)
+        except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
+            pass
+    return running_chromes
+
+
+def collect_executable_paths(processes):
+    executable_paths = set()
+    for process in processes:
+        try:
+            executable_paths.add(process.exe())
+        except (psutil.NoSuchProcess, psutil.AccessDenied):
+            pass
+    return executable_paths
+
+
+def wait_for_processes_to_exit(processes, timeout_seconds):
+    deadline = time.time() + timeout_seconds
+    remaining = processes
+    while len(remaining) > 0 and time.time() < deadline:
+        still_running = []
+        for process in remaining:
+            try:
+                if process.is_running():
+                    still_running.append(process)
+            except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
+                pass
+        remaining = still_running
+        if len(remaining) > 0:
+            time.sleep(0.2)
+    return remaining
+
+
+def gracefully_quit_chrome_on_mac(running_chromes):
+    app_names = set()
+    for process in running_chromes:
+        try:
+            process_name = process.name()
+            if process_name in MAC_CHROME_APP_NAMES:
+                app_names.add(process_name)
+        except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
+            pass
+
+    for app_name in app_names:
+        applescript = f'tell application "{app_name}" to quit'
+        subprocess.run(
+            ['osascript', '-e', applescript],
+            stdout=subprocess.DEVNULL,
+            stderr=subprocess.DEVNULL,
+            check=False,
+        )
+
+
+def terminate_processes(processes):
+    for process in processes:
+        try:
+            if process.is_running():
+                process.terminate()
+        except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
+            pass
+
+
+def kill_processes(processes):
+    for process in processes:
+        try:
+            if process.is_running():
+                process.kill()
+        except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
             pass
+
+
+def shutdown_chrome():
+    running_chromes = collect_running_chromes()
+    if len(running_chromes) == 0:
+        return set()
+
+    terminated_chromes = collect_executable_paths(running_chromes)
+
+    if sys.platform == 'darwin':
+        gracefully_quit_chrome_on_mac(running_chromes)
+        running_chromes = wait_for_processes_to_exit(running_chromes, timeout_seconds=10)
+
+    if len(running_chromes) > 0:
+        terminate_processes(running_chromes)
+        running_chromes = wait_for_processes_to_exit(running_chromes, timeout_seconds=5)
+
+    if len(running_chromes) > 0:
+        kill_processes(running_chromes)
+
     return terminated_chromes
 
 
+def get_macos_app_bundle(executable_path):
+    marker = '.app/Contents/MacOS/'
+    if marker not in executable_path:
+        return None
+    return executable_path.split(marker)[0] + '.app'
+
+
+def restart_chrome(terminated_chromes):
+    for chrome in terminated_chromes:
+        try:
+            if sys.platform == 'darwin':
+                app_bundle = get_macos_app_bundle(chrome)
+                if app_bundle is not None and os.path.exists(app_bundle):
+                    subprocess.Popen(['open', '-a', app_bundle], stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
+                    continue
+            subprocess.Popen([chrome], stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
+        except OSError:
+            print('Failed to restart Chrome executable', chrome)
+
+
 def get_last_version(user_data_path):
     last_version_file = os.path.join(user_data_path, 'Last Version')
     if not os.path.exists(last_version_file):
@@ -143,18 +265,15 @@ def main():
         if last_version is None:
             print('Failed to get version. File not found', os.path.join(user_data_path, 'Last Version'))
             continue
-        main_version = int(last_version.split('.')[0])
         print('Patching Chrome', version, last_version, '"'+user_data_path+'"')
         patch_local_state(user_data_path, last_version)
 
     if len(terminated_chromes) > 0:
         print('Restart Chrome')
-        for chrome in terminated_chromes:
-            subprocess.Popen([chrome], stderr=subprocess.DEVNULL)
+        restart_chrome(terminated_chromes)
 
     input('Enter to continue...')
 
 
 if __name__ == '__main__':
     main()
-
